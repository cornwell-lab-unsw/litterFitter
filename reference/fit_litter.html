<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Non-linear fits of different models to the decomposition trajectory
of one cohort (as in typical litterbag studies) data.
Models range from very simple (and easy to fit with limited data)
to more complex."><title>Fit different models to single cohort decomposition data — fit_litter • litterfitter</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit different models to single cohort decomposition data — fit_litter"><meta property="og:description" content="Non-linear fits of different models to the decomposition trajectory
of one cohort (as in typical litterbag studies) data.
Models range from very simple (and easy to fit with limited data)
to more complex."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">litterfitter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/litterfitter.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cornwell-lab-unsw/litterfitter/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit different models to single cohort decomposition data</h1>
      <small class="dont-index">Source: <a href="https://github.com/cornwell-lab-unsw/litterfitter/blob/HEAD/R/optim-fxns.R" class="external-link"><code>R/optim-fxns.R</code></a></small>
      <div class="d-none name"><code>fit_litter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Non-linear fits of different models to the decomposition trajectory
of one cohort (as in typical litterbag studies) data.
Models range from very simple (and easy to fit with limited data)
to more complex.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_litter</span><span class="op">(</span></span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">mass.remaining</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"neg.exp"</span>, <span class="st">"weibull"</span>, <span class="st">"discrete.parallel"</span>, <span class="st">"discrete.series"</span>, <span class="st">"cont.quality"</span>,</span>
<span>    <span class="st">"neg.exp.limit"</span><span class="op">)</span>,</span>
<span>  iters <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>time</dt>
<dd><p>time since decomposition began, that is, ti-t0</p></dd>


<dt>mass.remaining</dt>
<dd><p>proportional mass loss, that is, mi/m0</p></dd>


<dt>model</dt>
<dd><p>there are five models currently implemented (see below)</p></dd>


<dt>iters</dt>
<dd><p>Number of random starts for the fitting.  Use higher numbers for models with larger numbers of parameters and for models that inherently tend to be less identifiable.</p></dd>


<dt>upper, lower</dt>
<dd><p><b>Optional</b> user specified values for the upper and lower bounds used by
<code>optim</code> in the fitting procedure. Use with care, only minimal sanity checking is currently
 implemented.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>returns a litfit object with the following elements:</p>
<p></p>
<ul><li><p><b>optimFit:</b> a list generated by the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> function</p></li>
<li><p><b>logLik:</b> the log-likelihood of the model</p></li>
<li><p><b>time:</b> vector of time (same as input)</p></li>
<li><p><b>mass:</b> vector os mass remaining (same as input)</p></li>
<li><p><b>predicted:</b> predicted values from the model for each of the points within time</p></li>
<li><p><b>model:</b> name of the model</p></li>
<li><p><b>nparams:</b> number of fit parameters in the model</p></li>
<li><p><b>AIC:</b> AIC of the model fit</p></li>
<li><p><b>AICc:</b> AICc of the model fit</p></li>
<li><p><b>BIC:</b> BIC of the model fit</p></li>
<li><p>and some other potentially useful things</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>the model likelihood is maximized using methods available in <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.  Optimization methods to be used within optim can be specified through the control object (i.e., control$method).  The default method is L-BFGS-B with bounds specific to each model. Each model</p><ul><li><p><b>weibull</b> The Weibull residence time model--two parameters (Frechet 1927)</p></li>
<li><p><b>discrete.parallel</b> Two pools in parallel with a term for the fraction of initial mass in each pool--three parameter (Manzoni et al. 2012)</p></li>
<li><p><b>discrete.series</b> A three parameter model in which there is the possibility of two sequential pools (Manzoni et al. 2012)</p></li>
<li><p><b>cont.quality</b> (Ågren and Bosatta 1996, see also Manzoni et al. 2012)</p></li>
</ul><p><em>Warning</em>: difficulty in finding the optimal solution is determined by an interaction between the nature and complexity of the 
likelihood space (which is both data- and model-dependent) as well as the optimization methods.  There is can never be a guarantee that the optimal solution is found, but using many random starting points will increase these odds.  It should be noted that there is significant variation among models in identifiability, with some models inherently less identifiable likely due to a tendency to form for flat ridges in likelihood space.  The confidence in the fit should be very low in these cases (see Cornwell and Weedon 2013).   A number of random starting points are used in optimization and are given through the iters.  The function checks whether the the top 10 optimizations have converged on the same likelihood, and if they have not this function will return a warning.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Ågren, G. and Bosatta, E. (1996) Quality: a bridge between theory and experiment in soil organic matter studies. Oikos, 76, 522–528.</p></li>
<li><p>Cornwell, W. K., and J. T. Weedon. (2013).  Decomposition trajectories of diverse litter types: a model selection analysis. Methods in Ecology and Evolution.</p></li>
<li><p>Frechet, M. (1927) Sur la loi de probabilite de lecart maximum. Ann de la Soc polonaise de Math, 6, 93–116.</p></li>
<li><p>Manzoni, S., Pineiro, G., Jackson, R. B., Jobbagy, E. G., Kim, J. H., &amp; Porporato, A. (2012). Analytical models of soil and litter decomposition: Solutions for mass loss and time-dependent decay rates. Soil Biology and Biochemistry, 50, 66-76.</p></li>
<li><p>Olson, J.S. (1963) Energy storage and the balance of producers and decomposers in ecological systems. Ecology, 44, 322–331.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>,
<code><a href="steady_state.html">steady_state</a></code>,
<code><a href="plot.litfit.html">plot.litfit</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Will Cornwell and James Weedon</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pineneedles</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">&lt;-</span><span class="fu">fit_litter</span><span class="op">(</span>time<span class="op">=</span><span class="va">pineneedles</span><span class="op">$</span><span class="va">Year</span>,mass.remaining<span class="op">=</span><span class="va">pineneedles</span><span class="op">$</span><span class="va">Mass.remaining</span>,</span></span>
<span class="r-in"><span>model<span class="op">=</span><span class="st">'neg.exp'</span>,iters<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of successful fits:  975  out of 1000 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Will Cornwell, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

